---

title: "PSConfigManager"
name: "PSConfigManager"
description: "Module for building and managing hierarchical configuration objects from templates."
category: "Configuration Management"
author: "Mario Mellunig"
authorUrl: "https://github.com/Thamielis"
tags: ["powershell", "configuration", "templates"]
lastUpdated: "2025-07-09"

---

## üöÄ Project Overview

PSConfigManager is a PowerShell module to dynamically create, manage, and extend hierarchical configurations with category-based templates, dependency rules, and IT-centric real-world structures.

---

## üß≠ Optimal Development Workflow

### High-Level Problem Solving & Iteration

* **Deep Understanding:** Analyze requirements and the root causes before coding.
* **Investigation:** Review all relevant files and dependencies to understand context and responsibilities.
* **Stepwise Planning:** Outline incremental plans before implementation.
* **Incremental Implementation:** Make logical, isolated changes and verify them thoroughly.
* **Rigorous Testing:** Run the full test suite after each change; iterate until all tests pass.
* **Reflection & Validation:** Review the solution, test edge cases, and add tests for uncovered logic.
* **Documentation & Changelog:**
  * Update all relevant documentation files (`README.md`, `CHANGELOG.md`, `ProjectArchitecture.md`, etc.) with every change.
  * Ensure documentation reflects all git commit history changes; backfill missing updates as needed.
  * Create any missing documentation files as per project standards.
* **Release Management:** Update module versioning and release notes after validated improvements.

> **Important:** Never finalize or commit code without all tests passing. New or changed code must meet ‚â•80% test coverage.

---

## ‚öôÔ∏è Tech Stack

| Layer         | Technology & Version                   |
|---------------|----------------------------------------|
| Language      | PowerShell 7+                          |
| Build         | InvokeBuild                            |
| Testing       | Pester v5+                             |
| Documentation | platyPS + Docsify                      |
| CI/CD         | GitHub Actions                         |
| Versioning    | Semantic Versioning via Git tags       |

---

## üìÅ Project Structure

### Key Directories

```shell
ProjectRoot/
‚îÇ   actions_bootstrap.ps1        # installs required modules for CI
‚îÇ   ProjectArchitecture.md
‚îÇ   README.md
‚îÇ   CHANGELOG.md
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ Config/                  # RequiredModules.psd1
‚îÇ   ‚îú‚îÄ‚îÄ Tests/                   # Pester tests
‚îÇ   ‚îú‚îÄ‚îÄ [ModuleName].build.ps1    # Invoke-Build tasks
‚îÇ   ‚îú‚îÄ‚îÄ [ModuleName].Settings.ps1 # build settings
‚îÇ   ‚îî‚îÄ‚îÄ [ModuleName]/             # module implementation
‚îÇ       ‚îú‚îÄ‚îÄ Public/
‚îÇ       ‚îú‚îÄ‚îÄ Private/
‚îÇ       ‚îú‚îÄ‚îÄ [ModuleName].psd1     # module manifest
‚îÇ       ‚îî‚îÄ‚îÄ [ModuleName].psm1     # merges Public/Private functions
‚îî‚îÄ‚îÄ docs/                        # platyPS generated help
```

* **/src/**
  * Module root: `/src/[ModuleName]/`
  * Build scripts: `/src/[ModuleName].build.ps1`, `/src/[ModuleName].Settings.ps1` (optional)
  * Configuration files: `/src/Config/`
    * RequiredModules.psd1: Contains required Modules for Build and Development (not required for users)
  * Tests: `/src/Tests/`
* **/docs/** ‚Äî Documentation files (Generated by CI/CD or build script from inline Help)
* **/Archiv/** ‚Äî For legacy or backup files (ignore and don¬¥t modify any files or folders in it)
* Dev/Build Bootstrap: `actions_bootstrap.ps1` for dependency bootstrapping during development (not required for users)

---

## üßë‚Äçüíª Development Guidelines

### Code Style

* Follow the [PowerShell Style Guide](https://aka.ms/psstyle) strictly.
* Always use approved Verbs for functions ('<Verb-Noun>')
* One function per file with full comment-based help preceding the function.
* Prefer strong typing and minimize variable scope.
* Use object-oriented design only when it benefits maintainability, extensibility or is requested.
* Use descriptive and unambiguous names for all identifiers.

### Naming Conventions

| Element  | Convention        | Description                            |
|----------|-------------------|----------------------------------------|
| Function | Verb-Noun         | Use approved verbs, descriptive nouns  |
| Variable | PascalCase        | Clear, self-explanatory variable names |
| File     | `<Verb-Noun>.ps1` | Match the primary function in the file |
| Class    | PascalCase        | For all classes and interfaces         |

### Documentation

* Create any missing documentation files as needed.
* Update `README.md`, `CHANGELOG.md`, `ProjectArchitecture.md`, and other relevant docs after every change.
* Ensure all documentation covers the entire git commit history; backfill if necessary.
* All functions and classes must have complete comment-based help blocks.
* Create or extend comprehensive PowerShell help documentation for each
  function and class. Fill out all standard sections‚ÄîSYNOPSIS, DESCRIPTION, PARAMETERS,
  INPUTS, OUTPUTS, NOTES, EXAMPLES, LINK, and COMPONENT‚Äîaccording to
  PowerShell best practices. Use markdown-compatible comment-based help with
  `.PARAMETER` tags for every parameter and provide at least two detailed
  examples.
* Markdown help is generated automatically in CI/CD or by running `Invoke-Build`.

### Development Steps

For Environment prerequisites:
  1. Run dependency bootstrap scripts (e.g., `./actions_bootstrap.ps1`).

1. Implement or modify functions with full inline help.
2. Create or update Pester tests for all new, changed or requested code (‚â•80% coverage for those parts).
3. Run all tests and validate coverage using your build system (`Invoke-Build -Task Test`)
4. If tests fail verify that tests are using valid cmdlets of Pester v5+ and refactor until tests pass.
5. If tests pass, update documentation files accordingly.
6. Commit only when all validations pass.
7. Update the module version in the `.psd1` file if user-visible changes occur.

---

## Output Format

When providing code or documentation changes, present them in Markdown in this order:

* **Function File:** Filename and PowerShell code
* **Test File:** Filename and Pester test code
* **Changelog Entry:** Markdown lines suitable for `CHANGELOG.md`
* **Architecture Update:** Only if the project structure or flow changes
* **Validation Summary:** Test run results and coverage percentage for the changes

Include only validated and CI/CD-ready outputs.

---

## Testing Strategy

### Unit Tests

* Tests should only processed by running `Invoke-Build -File ./src/PSConfigManager.build.ps1 -Task Test`.
* Each function must have its own associated `.Tests.ps1` file.
* Maintain at least 80% coverage on new, modified or instructed code.
* Cover edge cases and error handling.

### Integration/End-to-End Tests

* Create realistic scenarios to validate full workflows.
* Include concurrency and parallel execution tests if applicable.
* Update tests if changes or new scenarios occur

### CI/CD

* Automate linting, testing, and documentation generation on PRs and pushes.
* Build and release only on successful CI runs and passing tests.

---

## Build & Environment Setup

* Use `actions_bootstrap.ps1` or equivalent to install all required dependencies during development and CI.
* The bootstrap script is not necessary for end users consuming the module.

---

## Git Workflow

| Action          | Convention                                       |
|-----------------|--------------------------------------------------|
| Branch Naming   | `feature/<short-description>`, `fix/<issue>`     |
| Commit Messages | `feat(mod): add feature description #issue`      |
| Pull Requests   | Must include tests, documentation, and changelog |

---

## Security & Best Practices

* Validate all external inputs rigorously.
* Limit privileged operations to authorized users or roles.
* Log all critical changes for auditability.
* Review any changes affecting privileged data carefully.

---

## Validation Before Commit

* All tests must pass by running `Invoke-Build -File ./src/PSConfigManager.build.ps1 -Task Test`.
* New or changed code must have ‚â•80% coverage.
* No style or lint violations.
* Test and code files must be in sync.
* Documentation (README, CHANGELOG, Architecture) updated and accurate.
* Documentation must reflect all changes in git history.
* Create missing docs if absent.

---

## Release Checklist

* Tag a new version only after successful validation.
* Ensure CI pipeline passes.
* Update Changelog and `.psd1` version accordingly.
* Package and optionally publish the release.

---

## Performance Tips

* Use parallel execution (e.g., `-RunParallel`) for large data sets.
* Avoid race conditions or concurrent modification of shared resources.
* Use dry-run modes for safe previews during development.

---

## Architecture Overview

Provide a brief description of the core components or classes of the module here.
For example:

* **DataParser:** Parses input data from external systems.
* **SyncEngine:** Compares data and generates update tasks.
* **Handler:** Manages external system interactions.
* **Runner:** Manages parallelism and execution flow.

---

## Common Issues & Fixes

| Problem           | Suggested Fix               |
|-------------------|-----------------------------|
| [Common Issue 1]  | [How to fix or workaround]  |
| [Common Issue 2]  | [Recommended steps]         |

---

## Improvement Suggestions

* Automate changelog generation from commit or PR titles.
* Implement optional telemetry for usage analytics.
* Add multi-language or localization support.
* Optimize parallelism with dynamic throttling or batching.

---

## Resources

* [Pester Documentation](https://pester.dev/)
* [PowerShell Style Guide](https://aka.ms/psstyle)
* [PowerShell Cmdlets Documentation](https://learn.microsoft.com/powershell/)
* [platyPS Documentation](https://github.com/PowerShell/platyPS)
* [GitHub CLI Manual](https://cli.github.com/manual/gh_project)

---

## üìå Example Changelog Entry

```markdown
## [0.1.0] - YYYY-MM-DD

### Added

- Initial module scaffolding and core functions
- Test suite setup with Pester
- Documentation templates created

```

---

## Important Notes

* Build and CI/CD related scripts should be maintained separately and not interfere with module functionality.
* Always prioritize iterative testing and documentation with each change.
* Keep CHANGELOG and README synchronized with the full git commit history at all times.
* Enforce ‚â•80% test coverage only for new, changed or instructed code.
* Increment module version for any user-visible changes.
* Use semantic commit messages for clarity.
* Update help after any function changes.
* Avoid modifying CI or build pipelines unless necessary or instructed.

---

[End of AGENTS.md]
